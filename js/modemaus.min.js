$(function(){var a={ChromaticScaleVO:["C","C#/Db","D","D#/Eb","E","F","F#/Gb","G","G#/Ab","A","A#/Bb","B"],ChordsVO:[["major","major 7","suspended 4","add 6","add 9","major 9"],["minor","minor 7","minor 9","minor 11","minor 13"],["minor","minor 7","minor 11"],["major","major 7","add 9","add 6","major 9","major 7#11"],["major","dominant 7","suspended 4","add 9","add 6","dominant 7 suspended 4","major 9","major 11","major 13"],["minor","minor 7","minor 9","minor 11"],["diminished","diminished 7"]],ModesVO:[{name:"Ionian/Major",steps:[2,2,1,2,2,2,1],chorder:[0,1,2,3,4,5,6]},{name:"Dorian",steps:[2,1,2,2,2,1,2],chorder:[1,2,3,4,5,6,0]},{name:"Phrygian",steps:[1,2,2,2,1,2,2],chorder:[2,3,4,5,6,0,1]},{name:"Lydian",steps:[2,2,2,1,2,2,1],chorder:[3,4,5,6,0,1,2]},{name:"Mixolydian",steps:[2,2,1,2,2,1,2],chorder:[4,5,6,0,1,2,3]},{name:"Aeolian/Minor",steps:[2,1,2,2,1,2,2],chorder:[5,6,0,1,2,3,4]},{name:"Locrian",steps:[1,2,2,1,2,2,2],chorder:[6,0,1,2,3,4,5]}],Build:function(h,p){h=Number(h);var o=h;var g=[];for(var n=0,m=p.steps.length;n<m;n++){g.push(a.ChromaticScaleVO[o]);if(o+p.steps[n]>11){o-=12}o+=p.steps[n]}return{root:a.ChromaticScaleVO[h],name:p.name,scale:g,chorder:p.chorder}}};var b={target:$("#fretboard"),TuningsVO:[{name:"Standard",noteSpelling:["E","A","D","G","b","e"],chromaticNumbering:["4","9","2","7","11","4"]}],Draw:function(q){var p="";p+="<tr>";for(var r=0;r<12;r++){p+="<th>"+r+"</th>"}p+="</tr>";for(var h=0,m=6;h<m;h++){p+="<tr id='string"+h+"'>";for(var g=0,o=q.chromaticNumbering[h];g<12;g++){p+="<td>"+a.ChromaticScaleVO[o]+"</td>";if(o>=11){o-=11}else{o++}}p+="</tr>"}b.target.html(String(p))},ApplyMode:function(g){b.target.find("td").each(function(){var h=$(this).text();if(h==g[0]){$(this).addClass("rootOnFretboard")}else{if(h==g[3]){$(this).addClass("fourthOnFretboard")}else{if(h==g[4]){$(this).addClass("fifthOnFretboard")}else{if(h==g[1]||h==g[2]||h==g[5]||h==g[6]){$(this).addClass("noteOnFretboard")}else{$(this).addClass("notOnFretboard")}}}}})}};var f=function(g,r,q,m){$("#contentHeader").html("<h2>"+g+" "+r+"</h2>");var h=$("#outputPanel");var p="<table><tr><th>Note</th><th>Related Chords</th></tr>";for(var o=0,n=q.length;o<n;o++){p+="<tr";if(o==0){p+=' class="rootOnFretboard"'}else{if(o==3){p+=' class="fourthOnFretboard"'}else{if(o==4){p+=' class="fifthOnFretboard"'}else{p+=' class="noteOnFretboard"'}}}p+='><td class="scaleDegree">'+q[o]+'</td><td class="relatedChords">';for(k=0,l=a.ChordsVO[m[o]].length;k<l;k++){p+=""+q[o]+" "+a.ChordsVO[m[o]][k];if(k+1<l){p+=", "}}p+="</td></tr>"}p+="</table>";h.html(p)};var e=function(g,i){if(!g){g=$("#root").val()}if(!i){i=$("#scale").val()}var h=a.Build(g,a.ModesVO[Number(i)]);b.Draw(b.TuningsVO[0]);b.ApplyMode(h.scale);f(h.root,h.name,h.scale,h.chorder)};var d=function(s,g){if(!s){s=$("#txtSearch").val()}if(!g){var p=$("#searchHistory");p.slideDown("slow");$("<span class = '.prevSearch'><input type='button' value='"+s+"' /></span>").appendTo(p).bind("click",function(){d($(this).find("input").val(),true)})}var t=s.split(" ");var q,h;for(var o=0;o<t.length;o++){if(t[o].length==1){for(var n=0;n<a.ChromaticScaleVO.length;n++){if(t[o].toUpperCase()==a.ChromaticScaleVO[n]||t[o].toLowerCase()==a.ChromaticScaleVO[n]){q=n}}}else{if(t[o].length>1){var r=new RegExp(t[o],"i");for(var m=0;m<a.ModesVO.length;m++){if(a.ModesVO[m].name.match(r)){h=m}}}else{alert("No matches found!")}}}e(q,h)};var c=function(){e();$("#selectorForm").submit(function(){e();return false});$("#fmSearch").submit(function(){d();return false})}()});